# ToolsEnum

## ADRecon

> Source

    https://raw.githubusercontent.com/sense-of-security/ADRecon/master/ADRecon.ps1

> Commands

```powershell
powershell -ep bypass
.\ADRecon.ps1
.\ADRecon.ps1 -Protocol LDAP -DomainController DC_IP_ADDRESS -Credential pentest.lab\USERNAME
.\ADRecon.ps1 -Protocol ADWS -DomainController DC_IP_ADDRESS -Credential pentest.lab\USERNAME -Collect Domian, DCs
```

[Tools link (Git)](https://github.com/sense-of-security/ADRecon)

## PingCastle

wget https://github.com/vletoux/pingcastle/releases/download/2.9.1.0/PingCastle_2.9.1.0.zip


Run: `PingCastle.exe`

## PowerSploit


Download Link

    wget https://github.com/PowerShellMafia/PowerSploit/archive/v3.0.0.zip

### Command  

Import script

    Import-Module .\PowerSploit.psd1

List module 

    Get-Command -Module PowerSploit

Exploit list 

        Get-ExploitableSystem -Verbose
        
## PowerView

> Source

    https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon

> Import / View modules

```powershell
powershell -ep bypass
Import-Module .\Recon

Get-Command -Module Recon
```

> Commands

```powershell
Get-NetDomain

Get-NetDomainController

Get-NetDomainTrust

Get-NetComputer

Get-NetComputer –OperatingSystem "Windows 7 Ultimate"

(Get-DomainPolicy).”system access”

Get-NetGroup *admin*

Get-NetGroupMember -GroupName "Domain Admins"

Get-UserProperty –Properties pwdlastset

Invoke-ShareFinder
```

### USERHUNTING

```powershell
Find-LocalAdminAccess

Invoke-EnumerateLocalAdmin

Invoke-UserHunter
```

> Doc

    https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/active-directory-enumeration-with-powerview#get-netdomain
    https://www.exploit-db.com/docs/english/46990-active-directory-enumeration-with-powershell.pdf
    