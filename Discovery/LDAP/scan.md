# LDAP


## Nmap 

> TOP 20

    nmap --script=ldap-search 10.10.10.161 -p 389

> DumpAll

    nmap --script=ldap-search 10.10.10.161 -p 389 --script-args ldap.maxobjects=-1 > ldapDump

> DumpUser

    nmap --script=ldap-search 10.10.10.161 -p 389 --script-args ldap.maxobjects=-1 | grep "dn:" | grep "CN=Users" > ldapuser

> DumpAll with cread

    ldapdomaindump -u 'DOMAIN\john' -p MyP@ssW0rd 10.10.10.10 -o ~/Documents/AD_DUMP/

## ldapsearch

    ldapsearch -h 10.10.10.169 -p 389 -x -s base -b '' "(objectClass=*)" "*"

    ldapsearch -h 10.10.10.169 -p 389 -x -LLL -b "dc=htb,dc=local" 

    ldapsearch -h 10.10.10.169 -p 389 -x -LLL -b "dc=htb,dc=local" | grep userPrincipalName: > ldapuser

    
    ldapsearch -h 10.10.10.161 -p 389 -x -LLL -b "dc=htb,dc=local" "(objectclass=*)" 
