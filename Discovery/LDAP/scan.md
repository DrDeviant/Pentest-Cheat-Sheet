# LDAP


## Nmap 

> TOP 20

    nmap --script=ldap-search TARGET_IP -p 389

> DumpAll

    nmap --script=ldap-search TARGET_IP -p 389 --script-args ldap.maxobjects=-1 > ldapDump

> DumpUser

    nmap --script=ldap-search TARGET_IP -p 389 --script-args ldap.maxobjects=-1 | grep "dn:" | grep "CN=Users" > ldapuser

> DumpAll with cread

    ldapdomaindump -u 'DOMAIN\USERNAME' -p PASSWORD TARGET_IP -o ~/Documents/AD_DUMP/

## ldapsearch

    ldapsearch -h IP_ADDRESS -p 389 -x -s base nameingcontexts
    ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=htb,DC=LOCAL" '(objectClass=Person)'
    ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=htb,DC=LOCAL" '(objectClass=user)'
    ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=htb,DC=LOCAL" '(objectClass=User)' sAMAccountName | grep sAMAccountName | awk '{print $2}'> userLDAP.lst