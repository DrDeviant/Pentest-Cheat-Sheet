# LDAP - 389

Default port: `389/tcp`

## Nmap 

> TOP 20

    nmap --script=ldap-search TARGET_IP -p 389

> DumpAll

    nmap --script=ldap-search TARGET_IP -p 389 --script-args ldap.maxobjects=-1 > ldapDump

> DumpUser
```bash
nmap --script=ldap-search TARGET_IP -p 389 --script-args ldap.maxobjects=-1 | grep "dn:" | grep "CN=Users" > ldapuser
```
> DumpAll with cread
```bash
ldapdomaindump -u 'DOMAIN\USERNAME' -p PASSWORD TARGET_IP -o ~/Documents/AD_DUMP/
```
## ldapsearch
```bash
ldapsearch -h IP_ADDRESS -p 389 -x -s base nameingcontexts
ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=DOMAIN,DC=LOCAL" '(objectClass=Person)'
ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=DOMAIN,DC=LOCAL" '(objectClass=user)'
ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=DOMAIN,DC=LOCAL" '(objectClass=User)' sAMAccountName | grep sAMAccountName | awk '{print $2}'> userLDAP.lst
```
### ldapsearch with authentification 
```bash
ldapsearch -h IP_ADDRESS -p 389 -x -b "DC=DOMAIN,DC=LOCAL" '(objectClass=user)' -D USERNAME@DOMAIN -w 'PASSWORD'
```
## ADenum

git clone https://github.com/SecuProject/ADenum.git

    EnumAD.py -d DOMAIN.LOCAL
    
    EnumADAuth.py -d DOMAIN.LOCAL -u USERNAME -p PASSWORD -j -ip IP_ADDRESS