# RPC 

**RPCBind** default port: `111/tcp`

**RPCEnum** default port: `139/tcp,445/tcp`


## RPCBind (111)

```
rpcinfo â€“p TARGET_IP
rpcinfo DOMAIN_NAME
```

```
nfs-utils
```
```
nmap -p 111 --script=nfs-ls,nfs-statfs,nfs-showmount TARGET_IP
```
## RPC Enumeration (139/445)

> rpcclient

```zsh
rpcclient -U "" -N TARGET_IP
rpcclient -U "guest" -N TARGET_IP
rpcclient -U "" -N TARGET_IP -c getdompwinfo
```

> Look up sid
```zsh
lookupsid.py 'Domain/Username:PASSWORD@IP_ADDRESS'
```
> Dump all
```zsh
rpcdump.py 'Domain/Username:PASSWORD@IP_ADDRESS'
```
> Dump user 
```zsh
rpcclient -U "" -N TARGET_IP -c enumdomusers | awk -F '[][]' '{print $2}' > userRpc
``` 
> Interaction 

Server info

    srvinfo

RPC enum users

    rpc> enumdomusers

    user:[Guest] rid:[0x1f5]
    user:[AAD_987d7f2f57d2] rid:[0x450]

RPC enum users + Name

    rpc> querydispinfo

RPC enum group

    > enumdomgroups

        group:[Domain Users] rid:[0x201]
        group:[Domain Guests] rid:[0x202]
        group:[Domain Computers] rid:[0x203]

    > querygroup 0x201

        Group Name:	Domain Users
        Description:	
        Group Attribute:7
        Num Members:11

    > querygroupmem 0x44f

        rid:[0x451] attr:[0x7]

    > queryuser 0x451

        User Name   :	ryan
        Full Name   :	Ryan Bertrand

    getusrdompwinfo 0x451

RPC enum password

    getdompwinfo