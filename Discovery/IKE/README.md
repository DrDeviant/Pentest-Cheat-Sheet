# IKE 

## Word list 


    https://raw.githubusercontent.com/SpiderLabs/ikeforce/master/wordlists/groupnames.dic
    $seclists/Miscellaneous/ike-groupid.txt


## Enum

> Info about the endpoint 

    sudo ike-scan -M IP_ADDRESS

> Scan and enum

    iker -i ips.txt -o iker_output.txt -x iker_output.xml -v


### IPSec SNMP queries 

> public

    snmpwalk -v2c -c public IP_ADDRESS

> cisco 

    snmpwalk -v2c -c cisco1234 IP_ADDRESS

## Crack psk

    ikescan2john psk.txt > hash
    john --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt hash                 

## Connection
> Install tool 
> 
    yay -S strongswan

> Set secret

nano /etc/ipsec.secrets

    IP_ADDRESS : PSK "PASSWORD"

> Set configuration 

nano /etc/ipsec.conf

```
conn SERVER_NAME
    type=transport
    keyexchange=ikev1
    right=IP_ADDRESS
    authby=psk
    rightprotoport=tcp
    leftprotoport=tcp
    esp=3des-sha1
    ike=3des-sha1-modp1024
    auto=start
```


> Run new config 

    ipsec stop
    ipsec start --nofork



## Source 

    https://book.hacktricks.xyz/pentesting/ipsec-ike-vpn-pentesting#bruteforcing-id-with-ike-scan

