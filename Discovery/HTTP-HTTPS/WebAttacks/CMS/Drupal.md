# Drupal

## Enumeration

    cmsmap -f D http://IP_ADDRESS/

> Enumeration site 
 
    gobuster dir -w /usr/share/seclists/Discovery/Web-Content/CMS/Drupal.txt

### droopescan 

    droopescan scan drupal -u http://IP_ADDRESS/ -t 32

## Defaut database configuration path 

    /var/www/html/sites/default/settings.php

## Easy exploit 

    [M]  EDB-ID: 44449 "Drupal < 7.58 / < 8.3.9 / < 8.4.6 / < 8.5.1 - 'Drupalgeddon2' Remote Code Execution"
    [M]  EDB-ID: 44542 "Drupal < 7.58 - 'Drupalgeddon3' (Authenticated) Remote Code Execution (PoC)"
    [M]  EDB-ID: 44557 "Drupal < 7.58 - 'Drupalgeddon3' (Authenticated) Remote Code (Metasploit)

## Database

Default database:   drupal
Default user:       drupaluser 

### Dump users from the database
```sh
mysql -h IP_ADDRESS -u drupaluser --password='PASSWORD' -e 'use drupal; select * from users'
```

### Dump drupal database



Table: users

    mysqldump -h IP_ADDRESS -u 'drupaluser' -p drupal > data

# Sources 

- https://book.hacktricks.xyz/pentesting/pentesting-web/drupal#dump-users-from-db
    