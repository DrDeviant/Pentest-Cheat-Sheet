# Winrm

Default port: `5985/tcp` and `5986/tcp` of HTTPS


## On Windows 

Enable WinRM

```powershell
Enable-PSRemoting -Force
```

Configure WinRM

```powershell
winrm quickconfig
winrm set winrm/config/Client @{AllowUnencrypted = "true"}
Set-Item WSMan:localhost\client\trustedhosts -value *
```

## Tools

### Ruby script
```zsh
ruby evil-winrm.rb -i TARGET_IP -u USERNAME -P 5985 -p PASSWORD
> menu
```
### CME 
```zsh
cme winrm TARGET_IP -u USERNAME -p 'PASSWORD'
cme winrm TARGET_IP -u USERNAME -p 'PASSWORD' -x COMMAND
```
### evil-winrm
```zsh
evil-winrm -i TARGET_IP -u USERNAME -p 'PASSWORD'
```

Source 

    https://github.com/Hackplayers/evil-winrm.git