# NFS - Network File System

Default port: `111,2049/tcp`

## Enumeration

> Ports 

    nmap -sV -T4 -p111,2049 IP_ADDRESS

> Query rpcbind information

    rpcinfo -p IP_ADDRESS

e.g.

```
program vers proto   port  service
100000    2   udp    111   portmapper
100000    2   tcp    111   portmapper
100003    2   tcp    2049  nfs
100003    2   udp    2049  nfs
100005    2   tcp    2049  mountd
100005    2   udp    2049  mountd
```


```
rpcinfo -n 2049 -t IP_ADDRESS PROGRAM_NUM
```


> list of mountable drives

    showmount -e IP_ADDRESS

## Mount share

    mkdir /mnt/share
    mount IP_ADDRESS:/SHARE_PATH /mnt/share

    mount -t nfs -o vers=2 <ip>:<remote_folder> <local_folder> -o nolock

## Priv esc 

See:

https://book.hacktricks.xyz/linux-unix/privilege-escalation/nfs-no_root_squash-misconfiguration-pe


## Source

- https://book.hacktricks.xyz/pentesting/nfs-service-pentesting
- https://medium.com/@minimalist.ascent/pentesting-nfs-servers-a22090e1ec09